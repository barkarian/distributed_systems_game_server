import{S as e,i as r,s as n,e as t,t as o,j as i,c as a,a as l,b as s,d as u,l as f,f as c,g as p,h,n as g,E as m,Q as v,L as d,A as y,B as E,R as b,o as _,H as S,O as w,p as $,q as A,r as C,w as I,x as k,y as T,C as P,D as O,T as N,U as R,k as L}from"../chunks/index-a2f0fece.js";import{m as q,f as x,c as D,u as U}from"../chunks/store-bfd594f8.js";import{C as Q,a as j,I as K}from"../chunks/vendor-e90a73bf.js";var F,B=(function(e,r){r.Chess=function(e){var r="b",n="w",t=-1,o="p",i="b",a="k",l="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",s=["1-0","0-1","1/2-1/2","*"],u={b:[16,32,17,15],w:[-16,-32,-17,-15]},f={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},c=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],p=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],h={p:0,n:1,b:2,r:3,q:4,k:5},g={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},m={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},v={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},d={w:[{square:v.a1,flag:m.QSIDE_CASTLE},{square:v.h1,flag:m.KSIDE_CASTLE}],b:[{square:v.a8,flag:m.QSIDE_CASTLE},{square:v.h8,flag:m.KSIDE_CASTLE}]},y=new Array(128),E={w:t,b:t},b=n,_={w:0,b:0},S=t,w=0,$=1,A=[],C={},I={};function k(e){void 0===e&&(e=!1),y=new Array(128),E={w:t,b:t},b=n,_={w:0,b:0},S=t,w=0,$=1,A=[],e||(C={}),I={},q(R())}function T(){for(var e=[],r={},n=function(e){e in I&&(r[e]=I[e])};A.length>0;)e.push(Z());for(n(R());e.length>0;)J(e.pop()),n(R());I=r}function P(){O(l)}function O(e,o){void 0===o&&(o=!1);var i=e.split(/\s+/),a=i[0],l=0;if(!N(e).valid)return!1;k(o);for(var s=0;s<a.length;s++){var u=a.charAt(s);if("/"===u)l+=8;else if(-1!=="0123456789".indexOf(u))l+=parseInt(u,10);else{var f=u<"a"?n:r;D({type:u.toLowerCase(),color:f},ee(l)),l++}}return b=i[1],i[2].indexOf("K")>-1&&(_.w|=m.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(_.w|=m.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(_.b|=m.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(_.b|=m.QSIDE_CASTLE),S="-"===i[3]?t:v[i[3]],w=parseInt(i[4],10),$=parseInt(i[5],10),q(R()),!0}function N(e){var r="No errors.",n="FEN string must contain six space-delimited fields.",t="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",l="2nd field (side to move) is invalid.",s="1st field (piece positions) does not contain 8 '/'-delimited rows.",u="1st field (piece positions) is invalid [consecutive numbers].",f="1st field (piece positions) is invalid [invalid piece].",c="1st field (piece positions) is invalid [row too large].",p="Illegal en-passant square",h=e.split(/\s+/);if(6!==h.length)return{valid:!1,error_number:1,error:n};if(isNaN(h[5])||parseInt(h[5],10)<=0)return{valid:!1,error_number:2,error:t};if(isNaN(h[4])||parseInt(h[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(h[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(h[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(h[1]))return{valid:!1,error_number:6,error:l};var g=h[0].split("/");if(8!==g.length)return{valid:!1,error_number:7,error:s};for(var m=0;m<g.length;m++){for(var v=0,d=!1,y=0;y<g[m].length;y++)if(isNaN(g[m][y])){if(!/^[prnbqkPRNBQK]$/.test(g[m][y]))return{valid:!1,error_number:9,error:f};v+=1,d=!1}else{if(d)return{valid:!1,error_number:8,error:u};v+=parseInt(g[m][y],10),d=!0}if(8!==v)return{valid:!1,error_number:10,error:c}}return"3"==h[3][1]&&"w"==h[1]||"6"==h[3][1]&&"b"==h[1]?{valid:!1,error_number:11,error:p}:{valid:!0,error_number:0,error:r}}function R(){for(var e=0,r="",o=v.a8;o<=v.h1;o++){if(null==y[o])e++;else{e>0&&(r+=e,e=0);var i=y[o].color,a=y[o].type;r+=i===n?a.toUpperCase():a.toLowerCase()}o+1&136&&(e>0&&(r+=e),o!==v.h1&&(r+="/"),e=0,o+=8)}var l="";_.w&m.KSIDE_CASTLE&&(l+="K"),_.w&m.QSIDE_CASTLE&&(l+="Q"),_.b&m.KSIDE_CASTLE&&(l+="k"),_.b&m.QSIDE_CASTLE&&(l+="q"),l=l||"-";var s=S===t?"-":ee(S);return[r,b,l,s,w,$].join(" ")}function L(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(C[e[r]]=e[r+1]);return C}function q(e){A.length>0||(e!==l?(C.SetUp="1",C.FEN=e):(delete C.SetUp,delete C.FEN))}function x(e){var r=y[v[e]];return r?{type:r.type,color:r.color}:null}function D(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(r in v))return!1;var n=v[r];return(e.type!=a||E[e.color]==t||E[e.color]==n)&&(y[n]={type:e.type,color:e.color},e.type===a&&(E[e.color]=n),q(R()),!0)}function U(e,r,n,t,i){var a={color:b,from:r,to:n,flags:t,piece:e[r].type};return i&&(a.flags|=m.PROMOTION,a.promotion=i),e[n]?a.captured=e[n].type:t&m.EP_CAPTURE&&(a.captured=o),a}function Q(e){function r(e,r,n,t,a){if(e[n].type!==o||0!==V(t)&&7!==V(t))r.push(U(e,n,t,a));else for(var l=["q","r",i,"n"],s=0,u=l.length;s<u;s++)r.push(U(e,n,t,a,l[s]))}var n=[],t=b,a=re(t),l={b:1,w:6},s=v.a8,c=v.h1,p=!1,h=void 0===e||!("legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in v))return[];s=c=v[e.square],p=!0}for(var g=s;g<=c;g++)if(136&g)g+=7;else{var d=y[g];if(null!=d&&d.color===t)if(d.type===o){var w=g+u[t][0];for(null==y[w]&&(r(y,n,g,w,m.NORMAL),w=g+u[t][1],l[t]===V(g)&&null==y[w]&&r(y,n,g,w,m.BIG_PAWN)),$=2;$<4;$++)136&(w=g+u[t][$])||(null!=y[w]&&y[w].color===a?r(y,n,g,w,m.CAPTURE):w===S&&r(y,n,g,S,m.EP_CAPTURE))}else for(var $=0,A=f[d.type].length;$<A;$++){var C=f[d.type][$];for(w=g;!(136&(w+=C));){if(null!=y[w]){if(y[w].color===t)break;r(y,n,g,w,m.CAPTURE);break}if(r(y,n,g,w,m.NORMAL),"n"===d.type||"k"===d.type)break}}}if(!p||c===E[t]){if(_[t]&m.KSIDE_CASTLE){var I=(k=E[t])+2;null!=y[k+1]||null!=y[I]||F(a,E[t])||F(a,k+1)||F(a,I)||r(y,n,E[t],I,m.KSIDE_CASTLE)}var k;if(_[t]&m.QSIDE_CASTLE)I=(k=E[t])-2,null!=y[k-1]||null!=y[k-2]||null!=y[k-3]||F(a,E[t])||F(a,k-1)||F(a,I)||r(y,n,E[t],I,m.QSIDE_CASTLE)}if(!h)return n;var T=[];for(g=0,A=n.length;g<A;g++)J(n[g]),B(t)||T.push(n[g]),Z();return T}function j(e,r){var n="";if(e.flags&m.KSIDE_CASTLE)n="O-O";else if(e.flags&m.QSIDE_CASTLE)n="O-O-O";else{var t=function(e,r){for(var n=Q({legal:!r}),t=e.from,o=e.to,i=e.piece,a=0,l=0,s=0,u=0,f=n.length;u<f;u++){var c=n[u].from,p=n[u].to;i===n[u].piece&&t!==c&&o===p&&(a++,V(t)===V(c)&&l++,Y(t)===Y(c)&&s++)}return a>0?l>0&&s>0?ee(t):s>0?ee(t).charAt(1):ee(t).charAt(0):""}(e,r);e.piece!==o&&(n+=e.piece.toUpperCase()+t),e.flags&(m.CAPTURE|m.EP_CAPTURE)&&(e.piece===o&&(n+=ee(e.from)[0]),n+="x"),n+=ee(e.to),e.flags&m.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return J(e),G()&&(M()?n+="#":n+="+"),Z(),n}function K(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function F(e,t){for(var i=v.a8;i<=v.h1;i++)if(136&i)i+=7;else if(null!=y[i]&&y[i].color===e){var a=y[i],l=i-t,s=l+119;if(c[s]&1<<h[a.type]){if(a.type===o){if(l>0){if(a.color===n)return!0}else if(a.color===r)return!0;continue}if("n"===a.type||"k"===a.type)return!0;for(var u=p[s],f=i+u,g=!1;f!==t;){if(null!=y[f]){g=!0;break}f+=u}if(!g)return!0}}return!1}function B(e){return F(re(e),E[e])}function G(){return B(b)}function M(){return G()&&0===Q().length}function W(){return!G()&&0===Q().length}function X(){for(var e={},r=[],n=0,t=0,o=v.a8;o<=v.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var a=y[o];a&&(e[a.type]=a.type in e?e[a.type]+1:1,a.type===i&&r.push(t),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var l=0,s=r.length;for(o=0;o<s;o++)l+=r[o];if(0===l||l===s)return!0}return!1}function H(){for(var e=[],r={},n=!1;;){var t=Z();if(!t)break;e.push(t)}for(;;){var o=R().split(" ").slice(0,4).join(" ");if(r[o]=o in r?r[o]+1:1,r[o]>=3&&(n=!0),!e.length)break;J(e.pop())}return n}function J(e){var n=b,i=re(n);if(function(e){A.push({move:e,kings:{b:E.b,w:E.w},turn:b,castling:{b:_.b,w:_.w},ep_square:S,half_moves:w,move_number:$})}(e),y[e.to]=y[e.from],y[e.from]=null,e.flags&m.EP_CAPTURE&&(b===r?y[e.to-16]=null:y[e.to+16]=null),e.flags&m.PROMOTION&&(y[e.to]={type:e.promotion,color:n}),y[e.to].type===a){if(E[y[e.to].color]=e.to,e.flags&m.KSIDE_CASTLE){var l=e.to-1,s=e.to+1;y[l]=y[s],y[s]=null}else e.flags&m.QSIDE_CASTLE&&(l=e.to+1,s=e.to-2,y[l]=y[s],y[s]=null);_[n]=""}if(_[n])for(var u=0,f=d[n].length;u<f;u++)if(e.from===d[n][u].square&&_[n]&d[n][u].flag){_[n]^=d[n][u].flag;break}if(_[i])for(u=0,f=d[i].length;u<f;u++)if(e.to===d[i][u].square&&_[i]&d[i][u].flag){_[i]^=d[i][u].flag;break}S=e.flags&m.BIG_PAWN?"b"===b?e.to-16:e.to+16:t,e.piece===o||e.flags&(m.CAPTURE|m.EP_CAPTURE)?w=0:w++,b===r&&$++,b=re(b)}function Z(){var e=A.pop();if(null==e)return null;var n=e.move;E=e.kings,b=e.turn,_=e.castling,S=e.ep_square,w=e.half_moves,$=e.move_number;var t,i,a=b,l=re(b);if(y[n.from]=y[n.to],y[n.from].type=n.piece,y[n.to]=null,n.flags&m.CAPTURE)y[n.to]={type:n.captured,color:l};else if(n.flags&m.EP_CAPTURE){var s;s=a===r?n.to-16:n.to+16,y[s]={type:o,color:l}}return n.flags&(m.KSIDE_CASTLE|m.QSIDE_CASTLE)&&(n.flags&m.KSIDE_CASTLE?(t=n.to+1,i=n.to-1):n.flags&m.QSIDE_CASTLE&&(t=n.to-2,i=n.to+1),y[t]=y[i],y[i]=null),n}function z(e,r){var n=K(e);if(r){var t=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(t)var o=t[1],i=t[2],a=t[3],l=t[4]}for(var s=Q(),u=0,f=s.length;u<f;u++){if(n===K(j(s[u]))||r&&n===K(j(s[u],!0)))return s[u];if(t&&(!o||o.toLowerCase()==s[u].piece)&&v[i]==s[u].from&&v[a]==s[u].to&&(!l||l.toLowerCase()==s[u].promotion))return s[u]}return null}function V(e){return e>>4}function Y(e){return 15&e}function ee(e){var r=Y(e),n=V(e);return"abcdefgh".substring(r,r+1)+"87654321".substring(n,n+1)}function re(e){return e===n?r:n}function ne(e){var r=te(e);r.san=j(r,!1),r.to=ee(r.to),r.from=ee(r.from);var n="";for(var t in m)m[t]&r.flags&&(n+=g[t]);return r.flags=n,r}function te(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"==typeof n?te(e[n]):e[n];return r}function oe(e){return e.replace(/^\s+|\s+$/g,"")}function ie(e){for(var r=Q({legal:!1}),n=0,t=b,o=0,i=r.length;o<i;o++)J(r[o]),B(t)||(e-1>0?n+=ie(e-1):n++),Z();return n}return O(void 0===e?l:e),{WHITE:n,BLACK:r,PAWN:o,KNIGHT:"n",BISHOP:i,ROOK:"r",QUEEN:"q",KING:a,SQUARES:function(){for(var e=[],r=v.a8;r<=v.h1;r++)136&r?r+=7:e.push(ee(r));return e}(),FLAGS:g,load:function(e){return O(e)},reset:function(){return P()},moves:function(e){for(var r=Q(e),n=[],t=0,o=r.length;t<o;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(ne(r[t])):n.push(j(r[t],!1));return n},in_check:function(){return G()},in_checkmate:function(){return M()},in_stalemate:function(){return W()},in_draw:function(){return w>=100||W()||X()||H()},insufficient_material:function(){return X()},in_threefold_repetition:function(){return H()},game_over:function(){return w>=100||M()||W()||X()||H()},validate_fen:function(e){return N(e)},fen:function(){return R()},board:function(){for(var e=[],r=[],n=v.a8;n<=v.h1;n++)null==y[n]?r.push(null):r.push({type:y[n].type,color:y[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var r="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,t=[],o=!1;for(var i in C)t.push("["+i+' "'+C[i]+'"]'+r),o=!0;o&&A.length&&t.push(r);for(var a=function(e){var r=I[R()];return void 0!==r&&(e=`${e}${e.length>0?" ":""}{${r}}`),e},l=[];A.length>0;)l.push(Z());var s=[],u="";for(0===l.length&&s.push(a(""));l.length>0;){u=a(u);var f=l.pop();A.length||"b"!==f.color?"w"===f.color&&(u.length&&s.push(u),u=$+"."):u=$+". ...",u=u+" "+j(f,!1),J(f)}if(u.length&&s.push(a(u)),void 0!==C.Result&&s.push(C.Result),0===n)return t.join("")+s.join(" ");var c=function(){return t.length>0&&" "===t[t.length-1]&&(t.pop(),!0)},p=function(e,o){for(var i of o.split(" "))if(i){if(e+i.length>n){for(;c();)e--;t.push(r),e=0}t.push(i),e+=i.length,t.push(" "),e++}return c()&&e--,e},h=0;for(i=0;i<s.length;i++)h+s[i].length>n&&s[i].includes("{")?h=p(h,s[i]):(h+s[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(r),h=0):0!==i&&(t.push(" "),h++),t.push(s[i]),h+=s[i].length);return t.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var o="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+t(o)+")|.)*\\])(?:"+t(o)+"){2}"),a=i.test(e)?i.exec(e)[1]:"";P();var l=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o={},i=e.split(new RegExp(t(n))),a="",l="",s=0;s<i.length;s++)a=i[s].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),l=i[s].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),oe(a).length>0&&(o[a]=l);return o}(a,r);for(var u in l)L([u,l[u]]);if(!("1"!==l.SetUp||"FEN"in l&&O(l.FEN,!0)))return!1;for(var f=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(t(o),"g")," ")).slice(1,e.length-1))}}`},c=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},p=e.replace(a,"").replace(new RegExp(`({[^}]*})+?|;([^${t(o)}]*)`,"g"),(function(e,r,n){return void 0!==r?f(r):" "+f(`{${n.slice(1)}}`)})).replace(new RegExp(t(o),"g")," "),h=/(\([^\(\)]+\))+?/g;h.test(p);)p=p.replace(h,"");var g=oe(p=(p=(p=p.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));g=g.join(",").replace(/,,+/g,",").split(",");for(var m="",v=0;v<g.length-1;v++){var d=c(g[v]);if(void 0===d){if(null==(m=z(g[v],n)))return!1;J(m)}else I[R()]=d}if(void 0!==(d=c(g[g.length-1]))&&(I[R()]=d,g.pop()),m=g[g.length-1],s.indexOf(m)>-1)(function(e){for(var r in e)return!0;return!1})(C)&&void 0===C.Result&&L(["Result",m]);else{if(null==(m=z(m,n)))return!1;J(m)}return!0},header:function(){return L(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",r=v.a8;r<=v.h1;r++){if(0===Y(r)&&(e+=" "+"87654321"[V(r)]+" |"),null==y[r])e+=" . ";else{var t=y[r].type;e+=" "+(y[r].color===n?t.toUpperCase():t.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return b},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=z(e,n);else if("object"==typeof e)for(var o=Q(),i=0,a=o.length;i<a;i++)if(e.from===ee(o[i].from)&&e.to===ee(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){t=o[i];break}if(!t)return null;var l=ne(t);return J(t),l},undo:function(){var e=Z();return e?ne(e):null},clear:function(){return k()},put:function(e,r){return D(e,r)},get:function(e){return x(e)},remove:function(e){return function(e){var r=x(e);return y[v[e]]=null,r&&r.type===a&&(E[r.color]=t),q(R()),r}(e)},perft:function(e){return ie(e)},square_color:function(e){if(e in v){var r=v[e];return(V(r)+Y(r))%2==0?"light":"dark"}return null},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);A.length>0;)r.push(Z());for(;r.length>0;){var o=r.pop();t?n.push(ne(o)):n.push(j(o)),J(o)}return n},get_comment:function(){return I[R()]},set_comment:function(e){I[R()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=I[R()];return delete I[R()],e},get_comments:function(){return T(),Object.keys(I).map((function(e){return{fen:e,comment:I[e]}}))},delete_comments:function(){return T(),Object.keys(I).map((function(e){var r=I[e];return delete I[e],{fen:e,comment:r}}))}}}}(F={exports:{}},F.exports),F.exports);function G(e){let r,n,m,v,d,y,E,b,_,S,w,$;return{c(){r=t("p"),n=o("In check:"),m=o(e[0]),v=i(),d=t("p"),y=o("In checkmate:"),E=o(e[1]),b=i(),_=t("p"),S=o(e[3]),w=i(),$=t("div")},l(t){r=a(t,"P",{});var o=l(r);n=s(o,"In check:"),m=s(o,e[0]),o.forEach(u),v=f(t),d=a(t,"P",{});var i=l(d);y=s(i,"In checkmate:"),E=s(i,e[1]),i.forEach(u),b=f(t),_=a(t,"P",{});var c=l(_);S=s(c,e[3]),c.forEach(u),w=f(t),$=a(t,"DIV",{}),l($).forEach(u)},m(t,o){c(t,r,o),p(r,n),p(r,m),c(t,v,o),c(t,d,o),p(d,y),p(d,E),c(t,b,o),c(t,_,o),p(_,S),c(t,w,o),c(t,$,o),e[7]($)},p(e,[r]){1&r&&h(m,e[0]),2&r&&h(E,e[1]),8&r&&h(S,e[3])},i:g,o:g,d(n){n&&u(r),n&&u(v),n&&u(d),n&&u(b),n&&u(_),n&&u(w),n&&u($),e[7](null)}}}function M(e,r,n){let t,o;m(e,q,(e=>n(10,t=e))),m(e,x,(e=>n(11,o=e)));let i,a,l,s,u,f,{playingFirst:c}=r,{fen:p}=r,{myturn:h=!0}=r;function g(e){if(e.type===K.moveDone){const r={from:e.squareFrom,to:e.squareTo},n=i.move(r);return n&&h?(d(q,t=r,t),d(x,o=i.fen(),o)):h?console.warn("invalid move",r):e.chessboard.disableMoveInput(),n}return!0}return v((async()=>{await u.destroy(),d(x,o="",o),d(q,t="",t)})),y((async()=>{i=new B.Chess(p),u.setPosition(i.fen()),n(0,a=i.in_check()),n(1,l=i.in_checkmate()),!1===c&&u.setOrientation(Q.black),h?(1==i.in_checkmate()?n(3,f="Game is finished :you lost ðŸ¥º"):1==i.in_stalemate()?n(3,f="Game is finished :It's a tie ðŸ‘”"):n(3,f="Game in Progress ðŸ”¥"),u.enableMoveInput(g)):(1==i.in_checkmate()?n(3,f="Game is finished :you Win ðŸ˜Ž"):1==i.in_stalemate()?(console.log(i.in_stalemate()),n(3,f="Game is finished :It's a tie ðŸ‘”")):n(3,f="Game in Progress ðŸ”¥"),u.disableMoveInput(g))})),E((async()=>{(()=>{const e=document.createElement("div");e.id="board1",e.style="width: 400px",s.appendChild(e),u=new j(document.getElementById("board1"),{position:"start",sprite:{url:"/assets/images/chessboard-sprite-staunty.svg"},orientation:Q.white})})()})),e.$$set=e=>{"playingFirst"in e&&n(4,c=e.playingFirst),"fen"in e&&n(5,p=e.fen),"myturn"in e&&n(6,h=e.myturn)},[a,l,s,f,c,p,h,function(e){b[e?"unshift":"push"]((()=>{s=e,n(2,s)}))}]}class W extends e{constructor(e){super(),r(this,e,M,G,n,{playingFirst:4,fen:5,myturn:6})}}function X(e){let r,n,i,f,m=(e[0]||"")+"";return{c(){r=t("button"),n=o(m),this.h()},l(e){r=a(e,"BUTTON",{class:!0});var t=l(r);n=s(t,m),t.forEach(u),this.h()},h(){_(r,"class","square svelte-1yp11ow")},m(t,o){c(t,r,o),p(r,n),i||(f=S(r,"click",(function(){w(e[1])&&e[1].apply(this,arguments)})),i=!0)},p(r,[t]){e=r,1&t&&m!==(m=(e[0]||"")+"")&&h(n,m)},i:g,o:g,d(e){e&&u(r),i=!1,f()}}}function H(e,r,n){let{value:t}=r,{handleClick:o}=r;return e.$$set=e=>{"value"in e&&n(0,t=e.value),"handleClick"in e&&n(1,o=e.handleClick)},[t,o]}class J extends e{constructor(e){super(),r(this,e,H,X,n,{value:0,handleClick:1})}}function Z(e,r,n){const t=e.slice();return t[10]=r[n],t[12]=n,t}function z(e){let r,n;return{c(){r=t("h3"),n=o(e[2]),this.h()},l(t){r=a(t,"H3",{class:!0});var o=l(r);n=s(o,e[2]),o.forEach(u),this.h()},h(){_(r,"class","svelte-dt6evk")},m(e,t){c(e,r,t),p(r,n)},p(e,r){4&r&&h(n,e[2])},d(e){e&&u(r)}}}function V(e){let r,n;return{c(){r=t("h3"),n=o(e[1]),this.h()},l(t){r=a(t,"H3",{class:!0});var o=l(r);n=s(o,e[1]),o.forEach(u),this.h()},h(){_(r,"class","svelte-dt6evk")},m(e,t){c(e,r,t),p(r,n)},p(e,r){2&r&&h(n,e[1])},d(e){e&&u(r)}}}function Y(e){let r,n;return r=new J({props:{value:e[10],handleClick:function(){return e[7](e[12])}}}),{c(){$(r.$$.fragment)},l(e){A(r.$$.fragment,e)},m(e,t){C(r,e,t),n=!0},p(n,t){e=n;const o={};1&t&&(o.value=e[10]),r.$set(o)},i(e){n||(I(r.$$.fragment,e),n=!0)},o(e){k(r.$$.fragment,e),n=!1},d(e){T(r,e)}}}function ee(e){let r,n,o;function s(e,r){return e[1]?V:z}let p=s(e),h=p(e),g=e[0],m=[];for(let t=0;t<g.length;t+=1)m[t]=Y(Z(e,g,t));const v=e=>k(m[e],1,1,(()=>{m[e]=null}));return{c(){h.c(),r=i(),n=t("div");for(let e=0;e<m.length;e+=1)m[e].c();this.h()},l(e){h.l(e),r=f(e),n=a(e,"DIV",{class:!0});var t=l(n);for(let r=0;r<m.length;r+=1)m[r].l(t);t.forEach(u),this.h()},h(){_(n,"class","board svelte-dt6evk")},m(e,t){h.m(e,t),c(e,r,t),c(e,n,t);for(let r=0;r<m.length;r+=1)m[r].m(n,null);o=!0},p(e,[t]){if(p===(p=s(e))&&h?h.p(e,t):(h.d(1),h=p(e),h&&(h.c(),h.m(r.parentNode,r))),9&t){let r;for(g=e[0],r=0;r<g.length;r+=1){const o=Z(e,g,r);m[r]?(m[r].p(o,t),I(m[r],1)):(m[r]=Y(o),m[r].c(),I(m[r],1),m[r].m(n,null))}for(P(),r=g.length;r<m.length;r+=1)v(r);O()}},i(e){if(!o){for(let e=0;e<g.length;e+=1)I(m[e]);o=!0}},o(e){m=m.filter(Boolean);for(let r=0;r<m.length;r+=1)k(m[r]);o=!1},d(e){h.d(e),e&&u(r),e&&u(n),N(m,e)}}}function re(e){const r=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let n=0;n<r.length;n++){const[t,o,i]=r[n];if(e[t]&&e[t]===e[o]&&e[t]===e[i])return`Winner: ${e[t]}`}return e.every((e=>null!==e))?"It's a draw":null}function ne(e,r,n){let t,o,i;m(e,x,(e=>n(8,o=e))),m(e,q,(e=>n(9,i=e)));let a,{iAmX:l=!0}=r,{myturn:s}=r,{squares:u}=r,f=null;function c(e){if(!s||f)return;u[e]||(n(0,u[e]=a?"X":"0",u),n(6,a=!a),n(1,f=re(u)),console.log({msg:"everything works fine",winnerMsg:f})),d(x,o=JSON.stringify(u),o);const r={player:a?"X":"0",from:"",to:`${e}`};if(f)switch(f){case"Winner: X":r.player="win";break;case"Winner: 0":r.player="win",console.log(l);break;case"It's a draw":r.player="tie",console.log("tie")}console.log(r),d(q,i=r,i)}y((async()=>{n(1,f=re(u))})),v((async()=>{d(x,o="",o),d(q,i="",i)}));return e.$$set=e=>{"iAmX"in e&&n(4,l=e.iAmX),"myturn"in e&&n(5,s=e.myturn),"squares"in e&&n(0,u=e.squares)},e.$$.update=()=>{48&e.$$.dirty&&n(6,a=!!(l&&1==s||!l&&0==s)),64&e.$$.dirty&&n(2,t="Next Player: "+(a?"X":"0"))},[u,f,t,c,l,s,a,e=>c(e)]}class te extends e{constructor(e){super(),r(this,e,ne,ee,n,{iAmX:4,myturn:5,squares:0})}}function oe(e){let r,n;return r=new te({props:{iAmX:e[0],myturn:e[1],squares:e[2]}}),{c(){$(r.$$.fragment)},l(e){A(r.$$.fragment,e)},m(e,t){C(r,e,t),n=!0},p(e,[n]){const t={};1&n&&(t.iAmX=e[0]),2&n&&(t.myturn=e[1]),4&n&&(t.squares=e[2]),r.$set(t)},i(e){n||(I(r.$$.fragment,e),n=!0)},o(e){k(r.$$.fragment,e),n=!1},d(e){T(r,e)}}}function ie(e,r,n){let t,{playingFirst:o}=r,{fen:i}=r,{myturn:a=!0}=r;return R((async()=>{n(2,t=JSON.parse(i))})),e.$$set=e=>{"playingFirst"in e&&n(0,o=e.playingFirst),"fen"in e&&n(3,i=e.fen),"myturn"in e&&n(1,a=e.myturn)},[o,a,t,i]}class ae extends e{constructor(e){super(),r(this,e,ie,oe,n,{playingFirst:0,fen:3,myturn:1})}}function le(e){let r,n,i;return{c(){r=t("h3"),n=o(e[1]),i=o("'s turn")},l(t){r=a(t,"H3",{});var o=l(r);n=s(o,e[1]),i=s(o,"'s turn"),o.forEach(u)},m(e,t){c(e,r,t),p(r,n),p(r,i)},p(e,r){2&r&&h(n,e[1])},d(e){e&&u(r)}}}function se(e){let r,n;return{c(){r=t("h3"),n=o("You're turn")},l(e){r=a(e,"H3",{});var t=l(r);n=s(t,"You're turn"),t.forEach(u)},m(e,t){c(e,r,t),p(r,n)},p:g,d(e){e&&u(r)}}}function ue(e){let r,n;return r=new ae({props:{playingFirst:e[2],fen:e[5],myturn:e[0]}}),{c(){$(r.$$.fragment)},l(e){A(r.$$.fragment,e)},m(e,t){C(r,e,t),n=!0},p(e,n){const t={};4&n&&(t.playingFirst=e[2]),32&n&&(t.fen=e[5]),1&n&&(t.myturn=e[0]),r.$set(t)},i(e){n||(I(r.$$.fragment,e),n=!0)},o(e){k(r.$$.fragment,e),n=!1},d(e){T(r,e)}}}function fe(e){let r,n;return r=new W({props:{playingFirst:e[2],fen:e[5],myturn:e[0]}}),{c(){$(r.$$.fragment)},l(e){A(r.$$.fragment,e)},m(e,t){C(r,e,t),n=!0},p(e,n){const t={};4&n&&(t.playingFirst=e[2]),32&n&&(t.fen=e[5]),1&n&&(t.myturn=e[0]),r.$set(t)},i(e){n||(I(r.$$.fragment,e),n=!0)},o(e){k(r.$$.fragment,e),n=!1},d(e){T(r,e)}}}function ce(e){let r,n,g,m,v,d,y,E,b;function _(e,r){return 1==e[0]?se:le}let S=_(e),w=S(e);const $=[fe,ue],A=[];function C(e,r){return"chess"==e[3]?0:"tic-tac-toe"==e[3]?1:-1}return~(d=C(e))&&(y=A[d]=$[d](e)),{c(){r=t("h1"),n=o("match_id is:"),g=o(e[4]),m=i(),w.c(),v=i(),y&&y.c(),E=L()},l(t){r=a(t,"H1",{});var o=l(r);n=s(o,"match_id is:"),g=s(o,e[4]),o.forEach(u),m=f(t),w.l(t),v=f(t),y&&y.l(t),E=L()},m(e,t){c(e,r,t),p(r,n),p(r,g),c(e,m,t),w.m(e,t),c(e,v,t),~d&&A[d].m(e,t),c(e,E,t),b=!0},p(e,[r]){(!b||16&r)&&h(g,e[4]),S===(S=_(e))&&w?w.p(e,r):(w.d(1),w=S(e),w&&(w.c(),w.m(v.parentNode,v)));let n=d;d=C(e),d===n?~d&&A[d].p(e,r):(y&&(P(),k(A[n],1,1,(()=>{A[n]=null})),O()),~d?(y=A[d],y?y.p(e,r):(y=A[d]=$[d](e),y.c()),I(y,1),y.m(E.parentNode,E)):y=null)},i(e){b||(I(y),b=!0)},o(e){k(y),b=!1},d(e){e&&u(r),e&&u(m),w.d(e),e&&u(v),~d&&A[d].d(e),e&&u(E)}}}function pe(e,r,n){let t,o,i,a;m(e,D,(e=>n(4,t=e))),m(e,U,(e=>n(8,o=e))),m(e,x,(e=>n(5,i=e))),m(e,q,(e=>n(7,a=e)));let l,s,u=!0,f=!0;let c;return E((async()=>{await(async()=>{try{const e=await fetch("http://localhost:5002/game/get-match-data",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t})}),r=await e.json();if("string"==typeof r)throw r;n(3,s=r.game_type),n(2,f=o.user_email==r.player1_email),o.user_email==r.player1_email?n(1,l=r.player2_email):n(1,l=r.player1_email),d(x,i=r.fen,i),r.cur_player==o.user_email?n(0,u=!0):n(0,u=!1)}catch(e){displayError=e}})()})),v((async()=>{d(D,t="",t),clearInterval(c)})),e.$$.update=()=>{65&e.$$.dirty&&(0==u?n(6,c=setInterval((()=>(async()=>{try{const e=await fetch("http://localhost:5002/game/my-turn",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t})}),r=await e.json();if("string"==typeof r)throw r;r.success&&(n(0,u=!0),d(x,i=r.match.fen,i))}catch(e){displayError=e}})()),1e3)):1==u&&clearInterval(c)),128&e.$$.dirty&&""!=a&&(async()=>{try{const e=await fetch("http://localhost:5002/game/make-move",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t,move:a,fen:i})}),r=await e.json();if("string"==typeof r)throw r;n(0,u=!1),d(x,i=r.fen,i)}catch(e){displayError=e}})()},[u,l,f,s,t,i,c,a]}export default class extends e{constructor(e){super(),r(this,e,pe,ce,n,{})}}
