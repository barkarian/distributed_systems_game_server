import{S as e,i as r,s as n,e as t,t as o,j as i,c as a,a as l,b as s,d as u,l as f,f as c,g as p,h,n as v,E as g,Q as m,L as d,A as y,B as E,R as _,p as b,q as S,r as A,w as I,x as C,y as w,k as T,D as P,C as k}from"../chunks/index-bf7fb778.js";import{m as R,f as O,c as L,u as N}from"../chunks/store-5de4d08f.js";import{C as q,a as $,I as D}from"../chunks/vendor-e90a73bf.js";var x,Q=(function(e,r){r.Chess=function(e){var r="b",n="w",t=-1,o="p",i="b",a="k",l="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",s=["1-0","0-1","1/2-1/2","*"],u={b:[16,32,17,15],w:[-16,-32,-17,-15]},f={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},c=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],p=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],h={p:0,n:1,b:2,r:3,q:4,k:5},v={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},g={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},m={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},d={w:[{square:m.a1,flag:g.QSIDE_CASTLE},{square:m.h1,flag:g.KSIDE_CASTLE}],b:[{square:m.a8,flag:g.QSIDE_CASTLE},{square:m.h8,flag:g.KSIDE_CASTLE}]},y=new Array(128),E={w:t,b:t},_=n,b={w:0,b:0},S=t,A=0,I=1,C=[],w={},T={};function P(e){void 0===e&&(e=!1),y=new Array(128),E={w:t,b:t},_=n,b={w:0,b:0},S=t,A=0,I=1,C=[],e||(w={}),T={},$(N())}function k(){for(var e=[],r={},n=function(e){e in T&&(r[e]=T[e])};C.length>0;)e.push(z());for(n(N());e.length>0;)Z(e.pop()),n(N());T=r}function R(){O(l)}function O(e,o){void 0===o&&(o=!1);var i=e.split(/\s+/),a=i[0],l=0;if(!L(e).valid)return!1;P(o);for(var s=0;s<a.length;s++){var u=a.charAt(s);if("/"===u)l+=8;else if(-1!=="0123456789".indexOf(u))l+=parseInt(u,10);else{var f=u<"a"?n:r;x({type:u.toLowerCase(),color:f},ee(l)),l++}}return _=i[1],i[2].indexOf("K")>-1&&(b.w|=g.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(b.w|=g.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(b.b|=g.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(b.b|=g.QSIDE_CASTLE),S="-"===i[3]?t:m[i[3]],A=parseInt(i[4],10),I=parseInt(i[5],10),$(N()),!0}function L(e){var r="No errors.",n="FEN string must contain six space-delimited fields.",t="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",l="2nd field (side to move) is invalid.",s="1st field (piece positions) does not contain 8 '/'-delimited rows.",u="1st field (piece positions) is invalid [consecutive numbers].",f="1st field (piece positions) is invalid [invalid piece].",c="1st field (piece positions) is invalid [row too large].",p="Illegal en-passant square",h=e.split(/\s+/);if(6!==h.length)return{valid:!1,error_number:1,error:n};if(isNaN(h[5])||parseInt(h[5],10)<=0)return{valid:!1,error_number:2,error:t};if(isNaN(h[4])||parseInt(h[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(h[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(h[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(h[1]))return{valid:!1,error_number:6,error:l};var v=h[0].split("/");if(8!==v.length)return{valid:!1,error_number:7,error:s};for(var g=0;g<v.length;g++){for(var m=0,d=!1,y=0;y<v[g].length;y++)if(isNaN(v[g][y])){if(!/^[prnbqkPRNBQK]$/.test(v[g][y]))return{valid:!1,error_number:9,error:f};m+=1,d=!1}else{if(d)return{valid:!1,error_number:8,error:u};m+=parseInt(v[g][y],10),d=!0}if(8!==m)return{valid:!1,error_number:10,error:c}}return"3"==h[3][1]&&"w"==h[1]||"6"==h[3][1]&&"b"==h[1]?{valid:!1,error_number:11,error:p}:{valid:!0,error_number:0,error:r}}function N(){for(var e=0,r="",o=m.a8;o<=m.h1;o++){if(null==y[o])e++;else{e>0&&(r+=e,e=0);var i=y[o].color,a=y[o].type;r+=i===n?a.toUpperCase():a.toLowerCase()}o+1&136&&(e>0&&(r+=e),o!==m.h1&&(r+="/"),e=0,o+=8)}var l="";b.w&g.KSIDE_CASTLE&&(l+="K"),b.w&g.QSIDE_CASTLE&&(l+="Q"),b.b&g.KSIDE_CASTLE&&(l+="k"),b.b&g.QSIDE_CASTLE&&(l+="q"),l=l||"-";var s=S===t?"-":ee(S);return[r,_,l,s,A,I].join(" ")}function q(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(w[e[r]]=e[r+1]);return w}function $(e){C.length>0||(e!==l?(w.SetUp="1",w.FEN=e):(delete w.SetUp,delete w.FEN))}function D(e){var r=y[m[e]];return r?{type:r.type,color:r.color}:null}function x(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(r in m))return!1;var n=m[r];return(e.type!=a||E[e.color]==t||E[e.color]==n)&&(y[n]={type:e.type,color:e.color},e.type===a&&(E[e.color]=n),$(N()),!0)}function Q(e,r,n,t,i){var a={color:_,from:r,to:n,flags:t,piece:e[r].type};return i&&(a.flags|=g.PROMOTION,a.promotion=i),e[n]?a.captured=e[n].type:t&g.EP_CAPTURE&&(a.captured=o),a}function j(e){function r(e,r,n,t,a){if(e[n].type!==o||0!==V(t)&&7!==V(t))r.push(Q(e,n,t,a));else for(var l=["q","r",i,"n"],s=0,u=l.length;s<u;s++)r.push(Q(e,n,t,a,l[s]))}var n=[],t=_,a=re(t),l={b:1,w:6},s=m.a8,c=m.h1,p=!1,h=void 0===e||!("legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in m))return[];s=c=m[e.square],p=!0}for(var v=s;v<=c;v++)if(136&v)v+=7;else{var d=y[v];if(null!=d&&d.color===t)if(d.type===o){var A=v+u[t][0];for(null==y[A]&&(r(y,n,v,A,g.NORMAL),A=v+u[t][1],l[t]===V(v)&&null==y[A]&&r(y,n,v,A,g.BIG_PAWN)),I=2;I<4;I++)136&(A=v+u[t][I])||(null!=y[A]&&y[A].color===a?r(y,n,v,A,g.CAPTURE):A===S&&r(y,n,v,S,g.EP_CAPTURE))}else for(var I=0,C=f[d.type].length;I<C;I++){var w=f[d.type][I];for(A=v;!(136&(A+=w));){if(null!=y[A]){if(y[A].color===t)break;r(y,n,v,A,g.CAPTURE);break}if(r(y,n,v,A,g.NORMAL),"n"===d.type||"k"===d.type)break}}}if(!p||c===E[t]){if(b[t]&g.KSIDE_CASTLE){var T=(P=E[t])+2;null!=y[P+1]||null!=y[T]||B(a,E[t])||B(a,P+1)||B(a,T)||r(y,n,E[t],T,g.KSIDE_CASTLE)}var P;if(b[t]&g.QSIDE_CASTLE)T=(P=E[t])-2,null!=y[P-1]||null!=y[P-2]||null!=y[P-3]||B(a,E[t])||B(a,P-1)||B(a,T)||r(y,n,E[t],T,g.QSIDE_CASTLE)}if(!h)return n;var k=[];for(v=0,C=n.length;v<C;v++)Z(n[v]),F(t)||k.push(n[v]),z();return k}function K(e,r){var n="";if(e.flags&g.KSIDE_CASTLE)n="O-O";else if(e.flags&g.QSIDE_CASTLE)n="O-O-O";else{var t=function(e,r){for(var n=j({legal:!r}),t=e.from,o=e.to,i=e.piece,a=0,l=0,s=0,u=0,f=n.length;u<f;u++){var c=n[u].from,p=n[u].to;i===n[u].piece&&t!==c&&o===p&&(a++,V(t)===V(c)&&l++,X(t)===X(c)&&s++)}return a>0?l>0&&s>0?ee(t):s>0?ee(t).charAt(1):ee(t).charAt(0):""}(e,r);e.piece!==o&&(n+=e.piece.toUpperCase()+t),e.flags&(g.CAPTURE|g.EP_CAPTURE)&&(e.piece===o&&(n+=ee(e.from)[0]),n+="x"),n+=ee(e.to),e.flags&g.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return Z(e),G()&&(M()?n+="#":n+="+"),z(),n}function U(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function B(e,t){for(var i=m.a8;i<=m.h1;i++)if(136&i)i+=7;else if(null!=y[i]&&y[i].color===e){var a=y[i],l=i-t,s=l+119;if(c[s]&1<<h[a.type]){if(a.type===o){if(l>0){if(a.color===n)return!0}else if(a.color===r)return!0;continue}if("n"===a.type||"k"===a.type)return!0;for(var u=p[s],f=i+u,v=!1;f!==t;){if(null!=y[f]){v=!0;break}f+=u}if(!v)return!0}}return!1}function F(e){return B(re(e),E[e])}function G(){return F(_)}function M(){return G()&&0===j().length}function W(){return!G()&&0===j().length}function H(){for(var e={},r=[],n=0,t=0,o=m.a8;o<=m.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var a=y[o];a&&(e[a.type]=a.type in e?e[a.type]+1:1,a.type===i&&r.push(t),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var l=0,s=r.length;for(o=0;o<s;o++)l+=r[o];if(0===l||l===s)return!0}return!1}function J(){for(var e=[],r={},n=!1;;){var t=z();if(!t)break;e.push(t)}for(;;){var o=N().split(" ").slice(0,4).join(" ");if(r[o]=o in r?r[o]+1:1,r[o]>=3&&(n=!0),!e.length)break;Z(e.pop())}return n}function Z(e){var n=_,i=re(n);if(function(e){C.push({move:e,kings:{b:E.b,w:E.w},turn:_,castling:{b:b.b,w:b.w},ep_square:S,half_moves:A,move_number:I})}(e),y[e.to]=y[e.from],y[e.from]=null,e.flags&g.EP_CAPTURE&&(_===r?y[e.to-16]=null:y[e.to+16]=null),e.flags&g.PROMOTION&&(y[e.to]={type:e.promotion,color:n}),y[e.to].type===a){if(E[y[e.to].color]=e.to,e.flags&g.KSIDE_CASTLE){var l=e.to-1,s=e.to+1;y[l]=y[s],y[s]=null}else e.flags&g.QSIDE_CASTLE&&(l=e.to+1,s=e.to-2,y[l]=y[s],y[s]=null);b[n]=""}if(b[n])for(var u=0,f=d[n].length;u<f;u++)if(e.from===d[n][u].square&&b[n]&d[n][u].flag){b[n]^=d[n][u].flag;break}if(b[i])for(u=0,f=d[i].length;u<f;u++)if(e.to===d[i][u].square&&b[i]&d[i][u].flag){b[i]^=d[i][u].flag;break}S=e.flags&g.BIG_PAWN?"b"===_?e.to-16:e.to+16:t,e.piece===o||e.flags&(g.CAPTURE|g.EP_CAPTURE)?A=0:A++,_===r&&I++,_=re(_)}function z(){var e=C.pop();if(null==e)return null;var n=e.move;E=e.kings,_=e.turn,b=e.castling,S=e.ep_square,A=e.half_moves,I=e.move_number;var t,i,a=_,l=re(_);if(y[n.from]=y[n.to],y[n.from].type=n.piece,y[n.to]=null,n.flags&g.CAPTURE)y[n.to]={type:n.captured,color:l};else if(n.flags&g.EP_CAPTURE){var s;s=a===r?n.to-16:n.to+16,y[s]={type:o,color:l}}return n.flags&(g.KSIDE_CASTLE|g.QSIDE_CASTLE)&&(n.flags&g.KSIDE_CASTLE?(t=n.to+1,i=n.to-1):n.flags&g.QSIDE_CASTLE&&(t=n.to-2,i=n.to+1),y[t]=y[i],y[i]=null),n}function Y(e,r){var n=U(e);if(r){var t=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(t)var o=t[1],i=t[2],a=t[3],l=t[4]}for(var s=j(),u=0,f=s.length;u<f;u++){if(n===U(K(s[u]))||r&&n===U(K(s[u],!0)))return s[u];if(t&&(!o||o.toLowerCase()==s[u].piece)&&m[i]==s[u].from&&m[a]==s[u].to&&(!l||l.toLowerCase()==s[u].promotion))return s[u]}return null}function V(e){return e>>4}function X(e){return 15&e}function ee(e){var r=X(e),n=V(e);return"abcdefgh".substring(r,r+1)+"87654321".substring(n,n+1)}function re(e){return e===n?r:n}function ne(e){var r=te(e);r.san=K(r,!1),r.to=ee(r.to),r.from=ee(r.from);var n="";for(var t in g)g[t]&r.flags&&(n+=v[t]);return r.flags=n,r}function te(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"==typeof n?te(e[n]):e[n];return r}function oe(e){return e.replace(/^\s+|\s+$/g,"")}function ie(e){for(var r=j({legal:!1}),n=0,t=_,o=0,i=r.length;o<i;o++)Z(r[o]),F(t)||(e-1>0?n+=ie(e-1):n++),z();return n}return O(void 0===e?l:e),{WHITE:n,BLACK:r,PAWN:o,KNIGHT:"n",BISHOP:i,ROOK:"r",QUEEN:"q",KING:a,SQUARES:function(){for(var e=[],r=m.a8;r<=m.h1;r++)136&r?r+=7:e.push(ee(r));return e}(),FLAGS:v,load:function(e){return O(e)},reset:function(){return R()},moves:function(e){for(var r=j(e),n=[],t=0,o=r.length;t<o;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(ne(r[t])):n.push(K(r[t],!1));return n},in_check:function(){return G()},in_checkmate:function(){return M()},in_stalemate:function(){return W()},in_draw:function(){return A>=100||W()||H()||J()},insufficient_material:function(){return H()},in_threefold_repetition:function(){return J()},game_over:function(){return A>=100||M()||W()||H()||J()},validate_fen:function(e){return L(e)},fen:function(){return N()},board:function(){for(var e=[],r=[],n=m.a8;n<=m.h1;n++)null==y[n]?r.push(null):r.push({type:y[n].type,color:y[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var r="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,t=[],o=!1;for(var i in w)t.push("["+i+' "'+w[i]+'"]'+r),o=!0;o&&C.length&&t.push(r);for(var a=function(e){var r=T[N()];return void 0!==r&&(e=`${e}${e.length>0?" ":""}{${r}}`),e},l=[];C.length>0;)l.push(z());var s=[],u="";for(0===l.length&&s.push(a(""));l.length>0;){u=a(u);var f=l.pop();C.length||"b"!==f.color?"w"===f.color&&(u.length&&s.push(u),u=I+"."):u=I+". ...",u=u+" "+K(f,!1),Z(f)}if(u.length&&s.push(a(u)),void 0!==w.Result&&s.push(w.Result),0===n)return t.join("")+s.join(" ");var c=function(){return t.length>0&&" "===t[t.length-1]&&(t.pop(),!0)},p=function(e,o){for(var i of o.split(" "))if(i){if(e+i.length>n){for(;c();)e--;t.push(r),e=0}t.push(i),e+=i.length,t.push(" "),e++}return c()&&e--,e},h=0;for(i=0;i<s.length;i++)h+s[i].length>n&&s[i].includes("{")?h=p(h,s[i]):(h+s[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(r),h=0):0!==i&&(t.push(" "),h++),t.push(s[i]),h+=s[i].length);return t.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var o="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+t(o)+")|.)*\\])(?:"+t(o)+"){2}"),a=i.test(e)?i.exec(e)[1]:"";R();var l=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o={},i=e.split(new RegExp(t(n))),a="",l="",s=0;s<i.length;s++)a=i[s].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),l=i[s].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),oe(a).length>0&&(o[a]=l);return o}(a,r);for(var u in l)q([u,l[u]]);if(!("1"!==l.SetUp||"FEN"in l&&O(l.FEN,!0)))return!1;for(var f=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(t(o),"g")," ")).slice(1,e.length-1))}}`},c=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},p=e.replace(a,"").replace(new RegExp(`({[^}]*})+?|;([^${t(o)}]*)`,"g"),(function(e,r,n){return void 0!==r?f(r):" "+f(`{${n.slice(1)}}`)})).replace(new RegExp(t(o),"g")," "),h=/(\([^\(\)]+\))+?/g;h.test(p);)p=p.replace(h,"");var v=oe(p=(p=(p=p.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));v=v.join(",").replace(/,,+/g,",").split(",");for(var g="",m=0;m<v.length-1;m++){var d=c(v[m]);if(void 0===d){if(null==(g=Y(v[m],n)))return!1;Z(g)}else T[N()]=d}if(void 0!==(d=c(v[v.length-1]))&&(T[N()]=d,v.pop()),g=v[v.length-1],s.indexOf(g)>-1)(function(e){for(var r in e)return!0;return!1})(w)&&void 0===w.Result&&q(["Result",g]);else{if(null==(g=Y(g,n)))return!1;Z(g)}return!0},header:function(){return q(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",r=m.a8;r<=m.h1;r++){if(0===X(r)&&(e+=" "+"87654321"[V(r)]+" |"),null==y[r])e+=" . ";else{var t=y[r].type;e+=" "+(y[r].color===n?t.toUpperCase():t.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return _},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=Y(e,n);else if("object"==typeof e)for(var o=j(),i=0,a=o.length;i<a;i++)if(e.from===ee(o[i].from)&&e.to===ee(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){t=o[i];break}if(!t)return null;var l=ne(t);return Z(t),l},undo:function(){var e=z();return e?ne(e):null},clear:function(){return P()},put:function(e,r){return x(e,r)},get:function(e){return D(e)},remove:function(e){return function(e){var r=D(e);return y[m[e]]=null,r&&r.type===a&&(E[r.color]=t),$(N()),r}(e)},perft:function(e){return ie(e)},square_color:function(e){if(e in m){var r=m[e];return(V(r)+X(r))%2==0?"light":"dark"}return null},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);C.length>0;)r.push(z());for(;r.length>0;){var o=r.pop();t?n.push(ne(o)):n.push(K(o)),Z(o)}return n},get_comment:function(){return T[N()]},set_comment:function(e){T[N()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=T[N()];return delete T[N()],e},get_comments:function(){return k(),Object.keys(T).map((function(e){return{fen:e,comment:T[e]}}))},delete_comments:function(){return k(),Object.keys(T).map((function(e){var r=T[e];return delete T[e],{fen:e,comment:r}}))}}}}(x={exports:{}},x.exports),x.exports);function j(e){let r,n,g,m,d,y,E,_,b,S,A,I;return{c(){r=t("p"),n=o("In check:"),g=o(e[0]),m=i(),d=t("p"),y=o("In checkmate:"),E=o(e[1]),_=i(),b=t("p"),S=o(e[3]),A=i(),I=t("div")},l(t){r=a(t,"P",{});var o=l(r);n=s(o,"In check:"),g=s(o,e[0]),o.forEach(u),m=f(t),d=a(t,"P",{});var i=l(d);y=s(i,"In checkmate:"),E=s(i,e[1]),i.forEach(u),_=f(t),b=a(t,"P",{});var c=l(b);S=s(c,e[3]),c.forEach(u),A=f(t),I=a(t,"DIV",{}),l(I).forEach(u)},m(t,o){c(t,r,o),p(r,n),p(r,g),c(t,m,o),c(t,d,o),p(d,y),p(d,E),c(t,_,o),c(t,b,o),p(b,S),c(t,A,o),c(t,I,o),e[7](I)},p(e,[r]){1&r&&h(g,e[0]),2&r&&h(E,e[1]),8&r&&h(S,e[3])},i:v,o:v,d(n){n&&u(r),n&&u(m),n&&u(d),n&&u(_),n&&u(b),n&&u(A),n&&u(I),e[7](null)}}}function K(e,r,n){let t,o;g(e,R,(e=>n(10,t=e))),g(e,O,(e=>n(11,o=e)));let i,a,l,s,u,f,{playingFirst:c}=r,{fen:p}=r,{myturn:h=!0}=r;function v(e){if(e.type===D.moveDone){const r={from:e.squareFrom,to:e.squareTo},n=i.move(r);return n&&h?(d(R,t=r,t),d(O,o=i.fen(),o)):h?console.warn("invalid move",r):e.chessboard.disableMoveInput(),n}return!0}return m((async()=>{await u.destroy(),d(O,o="",o),d(R,t="",t)})),y((async()=>{i=new Q.Chess(p),u.setPosition(i.fen()),n(0,a=i.in_check()),n(1,l=i.in_checkmate()),!1===c&&u.setOrientation(q.black),h?(1==i.in_checkmate()?n(3,f="Game is finished :you lost 🥺"):1==i.in_stalemate()?n(3,f="Game is finished :It's a tie 👔"):n(3,f="Game in Progress 🔥"),u.enableMoveInput(v)):(1==i.in_checkmate()?n(3,f="Game is finished :you Win 😎"):1==i.in_stalemate()?(console.log(i.in_stalemate()),n(3,f="Game is finished :It's a tie 👔")):n(3,f="Game in Progress 🔥"),u.disableMoveInput(v))})),E((async()=>{(()=>{const e=document.createElement("div");e.id="board1",e.style="width: 400px",s.appendChild(e),u=new $(document.getElementById("board1"),{position:"start",sprite:{url:"../../static/assets/images/chessboard-sprite-staunty.svg"},orientation:q.white})})()})),e.$$set=e=>{"playingFirst"in e&&n(4,c=e.playingFirst),"fen"in e&&n(5,p=e.fen),"myturn"in e&&n(6,h=e.myturn)},[a,l,s,f,c,p,h,function(e){_[e?"unshift":"push"]((()=>{s=e,n(2,s)}))}]}class U extends e{constructor(e){super(),r(this,e,K,j,n,{playingFirst:4,fen:5,myturn:6})}}function B(e){let r,n,i;return{c(){r=t("h3"),n=o(e[1]),i=o("'s turn")},l(t){r=a(t,"H3",{});var o=l(r);n=s(o,e[1]),i=s(o,"'s turn"),o.forEach(u)},m(e,t){c(e,r,t),p(r,n),p(r,i)},p(e,r){2&r&&h(n,e[1])},d(e){e&&u(r)}}}function F(e){let r,n;return{c(){r=t("h3"),n=o("You're turn")},l(e){r=a(e,"H3",{});var t=l(r);n=s(t,"You're turn"),t.forEach(u)},m(e,t){c(e,r,t),p(r,n)},p:v,d(e){e&&u(r)}}}function G(e){let r,n;return r=new U({props:{playingFirst:e[2],fen:e[5],myturn:e[0]}}),{c(){b(r.$$.fragment)},l(e){S(r.$$.fragment,e)},m(e,t){A(r,e,t),n=!0},p(e,n){const t={};4&n&&(t.playingFirst=e[2]),32&n&&(t.fen=e[5]),1&n&&(t.myturn=e[0]),r.$set(t)},i(e){n||(I(r.$$.fragment,e),n=!0)},o(e){C(r.$$.fragment,e),n=!1},d(e){w(r,e)}}}function M(e){let r,n,v,g,m,d,y;function E(e,r){return 1==e[0]?F:B}let _=E(e),b=_(e),S="chess"==e[3]&&G(e);return{c(){r=t("h1"),n=o("match_id is:"),v=o(e[4]),g=i(),b.c(),m=i(),S&&S.c(),d=T()},l(t){r=a(t,"H1",{});var o=l(r);n=s(o,"match_id is:"),v=s(o,e[4]),o.forEach(u),g=f(t),b.l(t),m=f(t),S&&S.l(t),d=T()},m(e,t){c(e,r,t),p(r,n),p(r,v),c(e,g,t),b.m(e,t),c(e,m,t),S&&S.m(e,t),c(e,d,t),y=!0},p(e,[r]){(!y||16&r)&&h(v,e[4]),_===(_=E(e))&&b?b.p(e,r):(b.d(1),b=_(e),b&&(b.c(),b.m(m.parentNode,m))),"chess"==e[3]?S?(S.p(e,r),8&r&&I(S,1)):(S=G(e),S.c(),I(S,1),S.m(d.parentNode,d)):S&&(k(),C(S,1,1,(()=>{S=null})),P())},i(e){y||(I(S),y=!0)},o(e){C(S),y=!1},d(e){e&&u(r),e&&u(g),b.d(e),e&&u(m),S&&S.d(e),e&&u(d)}}}function W(e,r,n){let t,o,i,a;g(e,L,(e=>n(4,t=e))),g(e,N,(e=>n(8,o=e))),g(e,O,(e=>n(5,i=e))),g(e,R,(e=>n(7,a=e)));let l,s,u,f=!0;let c;return E((async()=>{await(async()=>{try{const e=await fetch("http://localhost:5002/game/get-match-data",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t})}),r=await e.json();if("string"==typeof r)throw r;n(3,u=r.game_type),n(2,s=o.user_email==r.player1_email),o.user_email==r.player1_email?n(1,l=r.player2_email):n(1,l=r.player1_email),d(O,i=r.fen,i),r.cur_player==o.user_email?n(0,f=!0):n(0,f=!1)}catch(e){displayError=e}})()})),m((async()=>{d(L,t="",t),clearInterval(c)})),e.$$.update=()=>{65&e.$$.dirty&&(0==f?n(6,c=setInterval((()=>(async()=>{try{const e=await fetch("http://localhost:5002/game/my-turn",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t})}),r=await e.json();if("string"==typeof r)throw r;r.success&&(n(0,f=!0),d(O,i=r.match.fen,i))}catch(e){displayError=e}})()),1e3)):1==f&&clearInterval(c)),128&e.$$.dirty&&""!=a&&(async()=>{try{const e=await fetch("http://localhost:5002/game/make-move",{method:"POST",headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},body:JSON.stringify({match_id:t,move:a,fen:i})}),r=await e.json();if("string"==typeof r)throw r;n(0,f=!1),d(O,i=r.fen,i)}catch(e){displayError=e}})()},[f,l,s,u,t,i,c,a]}export default class extends e{constructor(e){super(),r(this,e,W,M,n,{})}}
